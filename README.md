This is implementation code from patterns.dev
